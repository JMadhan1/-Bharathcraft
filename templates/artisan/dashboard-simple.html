<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artisan Dashboard - Bharatcraft</title>
    <link rel="stylesheet" href="/static/css/artisan-simple.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="manifest" href="/static/manifest.json">
</head>

<body>
    <!-- Professional Header -->
    <header class="modern-header">
        <div class="logo">
            <img src="/static/logo.png" alt="Bharatcraft" onerror="this.style.display='none'">
            <span>Bharatcraft</span>
        </div>
        <div class="header-actions">
            <select id="languageSelector" class="language-selector" onchange="changeLanguage(this.value)">
                <option value="hi">हिंदी</option>
                <option value="te">తెలుగు</option>
                <option value="ta">தமிழ்</option>
                <option value="kn">ಕನ್ನಡ</option>
                <option value="ml">മലയാളം</option>
                <option value="bn">বাংলা</option>
                <option value="gu">ગુજરાતી</option>
                <option value="mr">मराठी</option>
                <option value="pa">ਪੰਜਾਬੀ</option>
                <option value="od">ଓଡ଼ିଆ</option>
                <option value="as">অসমীয়া</option>
                <option value="en">English</option>
            </select>
            <button class="voice-btn-header" onclick="startVoiceHelp()">
                <i class="fas fa-volume-up"></i>
                <span id="listenText">सुनें</span>
            </button>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
    </header>

    <!-- Notification Container -->
    <div id="notification-container"></div>

    <!-- Main Dashboard -->
    <main class="dashboard-main">
        <!-- Welcome Section -->
        <section class="welcome-section">
            <div class="welcome-content">
                <h1 id="userName">नमस्ते!</h1>
                <p class="welcome-subtitle">आपका स्वागत है</p>
            </div>
            <button class="voice-btn-large" onclick="playVoice('greeting')">
                <i class="fas fa-volume-up"></i>
            </button>
        </section>

        <!-- Quick Stats -->
        <section class="quick-stats">
            <div class="stat-card earnings-stat">
                <div class="stat-icon"><i class="fas fa-coins"></i></div>
                <div class="stat-content">
                    <p class="stat-label">कुल कमाई / Total Earnings</p>
                    <h2 class="stat-value">₹<span id="totalEarnings">0</span></h2>
                </div>
                <button class="voice-btn-stat" onclick="playVoice('earnings')">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
            <div class="stat-card products-stat">
                <div class="stat-icon"><i class="fas fa-box-open"></i></div>
                <div class="stat-content">
                    <p class="stat-label">उत्पाद / Products</p>
                    <h2 class="stat-value"><span id="productCount">0</span></h2>
                </div>
                <button class="voice-btn-stat" onclick="playVoice('products')">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
            <div class="stat-card orders-stat" onclick="showAllOrders()" style="cursor: pointer;">
                <div class="stat-icon"><i class="fas fa-shopping-cart"></i></div>
                <div class="stat-content">
                    <p class="stat-label">नए ऑर्डर / New Orders</p>
                    <h2 class="stat-value"><span id="orderCount">0</span></h2>
                </div>
                <button class="voice-btn-stat" onclick="event.stopPropagation(); playVoice('orders')">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
            <div class="stat-card messages-stat" onclick="showMessages()" style="cursor: pointer;">
                <div class="stat-icon"><i class="fas fa-comments"></i></div>
                <div class="stat-content">
                    <p class="stat-label">संदेश / Messages</p>
                    <h2 class="stat-value"><span id="messageCount">0</span></h2>
                </div>
                <button class="voice-btn-stat" onclick="event.stopPropagation(); playVoice('messages')">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
        </section>

        <!-- Main Action Cards -->
        <section class="action-grid">
            <!-- Upload Product -->
            <div class="action-card primary-card" onclick="showSimpleUpload()">
                <div class="card-icon-large">
                    <i class="fas fa-camera"></i>
                </div>
                <h3>फोटो खींचें<br><span class="en-text">Take Photo</span></h3>
                <p>अपने काम की फोटो लें और बेचें</p>
                <button class="voice-btn-card" onclick="playVoice('upload'); event.stopPropagation();">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>

            <!-- My Products -->
            <div class="action-card" onclick="showMyProducts()">
                <div class="card-icon-large">
                    <i class="fas fa-box-open"></i>
                </div>
                <h3>मेरा सामान<br><span class="en-text">My Products</span></h3>
                <p>आपके उत्पाद देखें और प्रबंधित करें</p>
                <button class="voice-btn-card" onclick="playVoice('my-products'); event.stopPropagation();">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>

            <!-- Orders -->
            <div class="action-card" onclick="showOrders()">
                <div class="card-icon-large">
                    <i class="fas fa-shopping-cart"></i>
                </div>
                <h3>ऑर्डर<br><span class="en-text">Orders</span></h3>
                <p>नए ऑर्डर देखें और स्वीकार करें</p>
                <button class="voice-btn-card" onclick="playVoice('view-orders'); event.stopPropagation();">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>

            <!-- Messages -->
            <div class="action-card" onclick="showMessages()">
                <div class="card-icon-large">
                    <i class="fas fa-comments"></i>
                </div>
                <h3>संदेश<br><span class="en-text">Messages</span></h3>
                <p>खरीदार से बात करें</p>
                <button class="voice-btn-card" onclick="playVoice('chat'); event.stopPropagation();">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>

            <!-- Logistics Cluster -->
            <div class="action-card cluster-card" onclick="viewClusterMap()">
                <div class="card-icon-large">
                    <i class="fas fa-truck"></i>
                </div>
                <h3>शिपिंग बचाएं<br><span class="en-text">Save on Shipping</span></h3>
                <p>60% तक बचत - समूह में शामिल हों</p>
                <div class="savings-badge">40% बचत</div>
                <button class="voice-btn-card" onclick="playVoice('logistics'); event.stopPropagation();">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>

            <!-- Help/Tutorial -->
            <div class="action-card" onclick="showVideoTutorial()">
                <div class="card-icon-large">
                    <i class="fas fa-play-circle"></i>
                </div>
                <h3>सीखें<br><span class="en-text">Learn</span></h3>
                <p>वीडियो ट्यूटोरियल देखें</p>
                <button class="voice-btn-card" onclick="playVoice('help'); event.stopPropagation();">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
        </section>

        <!-- Recent Products Section -->
        <section class="recent-section">
            <div class="section-header">
                <h2>हाल के उत्पाद / Recent Products</h2>
                <button class="voice-btn-section" onclick="playVoice('recent-products')">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
            <div id="recentProducts" class="products-grid"></div>
        </section>

        <!-- Pending Orders Section -->
        <section class="orders-section">
            <div class="section-header">
                <h2>लंबित ऑर्डर / Pending Orders</h2>
                <button class="voice-btn-section" onclick="playVoice('pending-orders')">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
            <div id="pendingOrders" class="orders-grid"></div>
        </section>
    </main>

    <!-- Simplified Upload Modal -->
    <div id="uploadModal" class="modal">
        <div class="modal-content upload-modal">
            <button class="close-btn" onclick="closeUploadModal()">
                <i class="fas fa-times"></i>
            </button>

            <h2>
                <span class="hindi">अपने काम की फोटो लें</span>
                <button class="voice-btn-inline" onclick="playVoice('upload-instruction')">
                    <i class="fas fa-volume-up"></i>
                </button>
            </h2>

            <form id="simpleUploadForm">
                <!-- Step 1: Photo -->
                <div class="upload-step active" id="step1">
                    <div class="photo-upload-area" onclick="document.getElementById('photoInput').click()">
                        <i class="fas fa-camera-retro"></i>
                        <p class="hindi">फोटो लेने के लिए यहाँ दबाएं</p>
                        <p class="english">Tap here to take photo</p>
                        <input type="file" id="photoInput" name="images" accept="image/*" capture="environment" multiple
                            style="display: none;" onchange="showPhotoPreview(this)">
                    </div>
                    <div id="photoPreview" class="photo-preview"></div>
                    <button type="button" class="big-next-btn" onclick="nextStep(2)" style="display: none;"
                        id="photoNextBtn">
                        <span class="hindi">आगे बढ़ें</span>
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>

                <!-- Step 2: Price -->
                <div class="upload-step" id="step2">
                    <label>
                        <span class="hindi">कीमत (₹)</span>
                        <button type="button" class="voice-btn-inline" onclick="playVoice('price-instruction')">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </label>
                    <div class="number-pad">
                        <input type="number" id="priceInput" name="price" inputmode="numeric" pattern="[0-9]*"
                            placeholder="100" required>
                        <div class="quick-price-buttons">
                            <button type="button" onclick="setPrice(50)">₹50</button>
                            <button type="button" onclick="setPrice(100)">₹100</button>
                            <button type="button" onclick="setPrice(200)">₹200</button>
                            <button type="button" onclick="setPrice(500)">₹500</button>
                            <button type="button" onclick="setPrice(1000)">₹1000</button>
                            <button type="button" onclick="setPrice(2000)">₹2000</button>
                        </div>
                    </div>
                    <div class="step-buttons">
                        <button type="button" class="back-btn" onclick="prevStep(1)">
                            <i class="fas fa-arrow-left"></i> <span class="hindi">पीछे</span>
                        </button>
                        <button type="button" class="big-next-btn" onclick="nextStep(3)">
                            <span class="hindi">आगे</span> <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 3: Description -->
                <div class="upload-step" id="step3">
                    <label>
                        <span class="hindi">अपने काम के बारे में बताएं</span>
                        <span class="english">(Optional - Speak or Type)</span>
                    </label>
                    <button type="button" class="voice-record-btn" onclick="startVoiceDescription()">
                        <i class="fas fa-microphone"></i>
                        <span class="hindi">बोलें</span>
                    </button>
                    <textarea id="descriptionInput" name="description" rows="3"
                        placeholder="या यहाँ लिखें..."></textarea>
                    <input type="hidden" name="title" id="titleInput">
                    <div class="step-buttons">
                        <button type="button" class="back-btn" onclick="prevStep(2)">
                            <i class="fas fa-arrow-left"></i> <span class="hindi">पीछे</span>
                        </button>
                        <button type="submit" class="big-submit-btn">
                            <i class="fas fa-check-circle"></i>
                            <span class="hindi">अपलोड करें</span>
                        </button>
                    </div>
                </div>
            </form>

            <!-- Loading State -->
            <div id="uploadingState" class="uploading-state" style="display: none;">
                <div class="spinner"></div>
                <p class="hindi">अपलोड हो रहा है...</p>
                <p class="english">Uploading...</p>
            </div>
        </div>
    </div>

    <!-- Cluster Map Modal -->
    <div id="mapModal" class="modal">
        <div class="modal-content map-modal">
            <div class="modal-header">
                <h3><i class="fas fa-map-marked-alt"></i> शिपिंग समूह / Logistics Clusters</h3>
                <span class="close" onclick="closeMapModal()">&times;</span>
            </div>
            <div id="clusterMap" style="height: 400px; width: 100%; border-radius: 8px;"></div>
            <div class="map-info">
                <p>
                    <i class="fas fa-info-circle"></i>
                    हरे घेरे सक्रिय समूह दिखाते हैं। शिपिंग लागत में 60% तक बचत के लिए समूह में शामिल हों।
                </p>
            </div>
        </div>
    </div>

    <!-- Products Modal -->
    <div id="productsModal" class="modal">
        <div class="modal-content products-modal">
            <div class="modal-header">
                <h3><i class="fas fa-box-open"></i> मेरा सामान / My Products</h3>
                <span class="close" onclick="closeProductsModal()">&times;</span>
            </div>
            <div id="allProducts" class="products-list"></div>
        </div>
    </div>

    <!-- Messages Modal -->
    <div id="messagesModal" class="modal">
        <div class="modal-content products-modal">
            <div class="modal-header">
                <h3><i class="fas fa-comments"></i> संदेश / Messages</h3>
                <span class="close" onclick="closeMessagesModal()">&times;</span>
            </div>
            <div id="allMessages" class="messages-list" style="padding: 1.5rem;">
                <p style="text-align: center; color: #6B7280;">संदेश लोड हो रहे हैं... / Loading messages...</p>
            </div>
        </div>
    </div>

    <!-- Orders Modal -->
    <div id="ordersModal" class="modal">
        <div class="modal-content orders-modal">
            <p class="hindi">आपका उत्पाद अपलोड हो गया</p>
        </div>

        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
        <script src="/static/js/auth-helper.js"></script>
        <script src="/static/js/artisan-simple.js"></script>
</body>

</html>